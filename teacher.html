<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>University LMS - Teacher</title>
  <link rel="stylesheet" href="./css/styles.css" />
</head>
<body>
  <header class="topbar">
    <h1>Teacher Dashboard</h1>
    <div>
      <span id="whoami"></span>
      <button id="logoutBtn" type="button">Logout</button>
    </div>
  </header>

  <main class="container">
    <section class="card">
      <h2>Classes & Enrollment</h2>
      <form id="classForm" class="grid two">
        <input id="className" placeholder="Class name (e.g., BSCS-5A)" required />
        <input id="classSubject" placeholder="Subject (e.g., Web Engineering)" required />
        <input id="semester" placeholder="Semester (e.g., Fall 2026)" required />
        <button type="submit">Create Class</button>
      </form>
      <form id="csvEnrollForm" class="grid two">
        <select id="enrollClassId" required></select>
        <input id="csvFile" type="file" accept=".csv" required />
        <button type="submit">Upload CSV & Enroll</button>
      </form>
      <p id="classEnrollMsg" class="message"></p>
      <div id="classesList" class="list"></div>
    </section>

    <section class="card">
      <h2>Lectures Delivered</h2>
      <form id="lectureForm" class="grid two">
        <select id="lectureClassId" required></select>
        <input id="lectureTitle" placeholder="Lecture title" required />
        <input id="lectureDate" type="date" required />
        <input id="lectureVideo" placeholder="Optional video link" />
        <input id="lectureFiles" type="file" multiple />
        <button type="submit">Save Lecture</button>
      </form>
      <input id="lectureId" type="hidden" />
      <div id="lecturesList" class="list"></div>
    </section>

    <section class="card">
      <h2>Quizzes (1-4 per class)</h2>
      <p class="meta">Workflow: select class/quiz -> add/edit questions -> auto-save draft -> publish -> start/stop attempts.</p>
      <div class="quiz-shell">
        <div class="quiz-left card">
          <h3>Quiz Setup</h3>
          <div id="quizBuilderStats" class="quiz-stats"></div>
          <form id="quizForm" class="grid">
            <select id="quizClassId" required></select>
            <select id="quizNumber" required>
              <option value="">Quiz Number</option>
              <option value="1">Quiz 1</option>
              <option value="2">Quiz 2</option>
              <option value="3">Quiz 3</option>
              <option value="4">Quiz 4</option>
            </select>
            <input id="quizTitle" placeholder="Quiz title" required />
            <select id="currentQuestionMode">
              <option value="mcq">Multiple Choice</option>
              <option value="theory">Short Question</option>
            </select>
            <input id="quizDuration" type="number" min="1" placeholder="Duration (minutes)" required />
            <input id="quizAttemptLimit" type="number" min="1" value="1" placeholder="Attempt limit per student" required />
            <label><input id="quizAntiCheat" type="checkbox" checked /> Enable anti-cheat (tab switch/copy protection)</label>
            <button id="addQuestionBtn" type="button">Add Question</button>
          </form>
          <p id="draftStatus" class="message quiz-draft-status"></p>
          <div class="inline-actions quiz-primary-actions">
            <button id="cancelQuestionEditBtn" type="button">Cancel Question Edit</button>
            <button id="saveDraftBtn" type="button">Save Draft</button>
            <button id="loadDraftBtn" type="button">Load Draft</button>
          </div>
          <div id="questionBuilder" class="builder"></div>
          <details open>
            <summary><strong>Import / Paste Questions</strong></summary>
            <form id="quizImportForm" class="grid two">
              <select id="quizImportMode">
                <option value="mixed">Mixed (MCQ + Theory)</option>
                <option value="mcq">MCQ only</option>
                <option value="theory">Theory only</option>
              </select>
              <input id="quizImportFile" type="file" accept=".csv,.txt" />
              <button type="submit">Bulk Import Questions (CSV)</button>
            </form>
            <p class="meta">CSV headers: <code>type,prompt,option1,option2,option3,option4,correctIndex,theoryAnswer</code></p>
            <textarea id="mcqPasteInput" rows="7" placeholder="Paste full MCQs/theory blocks here..."></textarea>
            <button id="parsePasteBtn" type="button">Parse Pasted Questions</button>
          </details>
          <div class="quiz-action-grid">
            <button id="publishCurrentDraftBtn" type="button">Publish Quiz</button>
            <button id="deleteCurrentDraftBtn" type="button">Delete Draft</button>
            <button id="archiveCurrentQuizBtn" type="button">Archive Quiz</button>
            <button id="restoreCurrentQuizBtn" type="button">Restore Quiz</button>
          </div>
        </div>
        <div class="quiz-right card">
          <h3>Preview</h3>
          <div class="quiz-top-filters grid two">
            <select id="quizPreviewClass"></select>
            <select id="quizPreviewSemester"></select>
          </div>
          <h4>Draft Preview</h4>
          <div id="quizDraftPreview" class="list"></div>
          <h4>Archived Quizzes</h4>
          <div id="archivedQuizzesPreview" class="list"></div>
        </div>
      </div>
      <input id="quizId" type="hidden" />
      <input id="quizDraftId" type="hidden" />
      <details>
        <summary><strong>All Drafts</strong></summary>
        <div id="quizDraftsList" class="list"></div>
      </details>
      <details>
        <summary><strong>All Quizzes</strong></summary>
        <div id="quizzesList" class="list"></div>
      </details>
      <details>
        <summary><strong>Quiz Analytics</strong></summary>
        <div id="quizAnalyticsList" class="list"></div>
      </details>
      <details>
        <summary><strong>Quiz Attempt Reviews (Short Questions)</strong></summary>
        <div id="quizAttemptReviewsList" class="list"></div>
      </details>
    </section>

    <section class="card">
      <h2>Assignments</h2>
      <form id="assignmentForm" class="grid two">
        <select id="assignmentClassId" required></select>
        <select id="assignmentNumber" required>
          <option value="">Assignment Number</option>
          <option value="1">Assignment 1</option>
          <option value="2">Assignment 2</option>
          <option value="3">Assignment 3</option>
          <option value="4">Assignment 4</option>
        </select>
        <input id="assignmentTitle" placeholder="Assignment title" required />
        <input id="assignmentDeadline" type="datetime-local" required />
        <button type="submit">Create Assignment</button>
      </form>
      <div id="assignmentsList" class="list"></div>
    </section>

    <section class="card">
      <h2>Teacher Evaluation (Aggregated Only)</h2>
      <div id="evaluationStatsList" class="list"></div>
    </section>

    <section class="card">
      <h2>Discussion Announcements</h2>
      <form id="announcementForm" class="grid two">
        <select id="announcementClassId" required></select>
        <input id="announcementTitle" placeholder="Announcement title" required />
        <textarea id="announcementBody" placeholder="Announcement body" required></textarea>
        <button type="submit">Post Announcement</button>
      </form>
      <div id="announcementList" class="list"></div>
    </section>
  </main>

  <script type="module" src="./js/teacher.js"></script>
</body>
</html>
